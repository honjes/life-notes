<mat-grid-list *ngIf="daysContents$ | async as daysContents; else loading" cols="1" gutterSize="0"
	class="timeline-grid">
	<div *ngIf="symptoms$ | async as symptoms; else loading">
		<mat-grid-tile *ngFor="let dayContent of daysContents" class="timeline-tile">
			<mat-grid-tile-header class="timeline-tile-header">
				<h3>{{ dayContent.date | date }}</h3>
				<button mat-icon-button class="go-to-day" routerLink="{{ dayContent.date }}">
					<mat-icon>arrow_forward_ios</mat-icon>
				</button>
				<button mat-icon-button [matMenuTriggerFor]="addEvent" class="add-event">
					<mat-icon>playlist_add</mat-icon>
				</button>
				<button mat-icon-button class="delete-event" (click)="toggleRemovable(dayContent)">
					<mat-icon>delete_sweep</mat-icon>
				</button>
				<mat-menu #addEvent="matMenu">
					<button mat-menu-item (click)="openAddSymptomDialog('symptomLog', dayContent.date, symptoms)">Add
						symptom</button>
					<button mat-menu-item (click)="openAddDialog('log', dayContent.date)">Add custom event</button>
					<button mat-menu-item (click)="openAddDialog('med', dayContent.date)">Add drug</button>
					<button mat-menu-item (click)="openAddDialog('meal', dayContent.date)">Add meal</button>
				</mat-menu>
			</mat-grid-tile-header>
			<div class="timeline-tile-content">
				<div class="corner-decoration"></div>
				<div class="wakeup-container" (click)="openAddDialog('wakeUp', dayContent.date)">
					<mat-icon class="wakeup-icon">alarm</mat-icon>
					<div class="wakeup-time">{{ dayContent.wakeUp }}</div>
				</div>
				<div class="gotobed-container" (click)="openAddDialog('goToBed', dayContent.date)">
					<mat-icon class="gotobed-icon">bedtime</mat-icon>
					<div class="gotobed-time">{{ dayContent.goToBed }}</div>
				</div>
				<div class="symptom-overview color-default">
					<mat-icon class="symptom-overview-icon">fiber_manual_record</mat-icon>
				</div>
				<div class="timeline-content">
					<mat-chip-list class="mat-chip-list-stacked">
						<div class="timeline-chips-padding"></div>
						<mat-chip *ngFor="let content of dayContent.content" [ngSwitch]="content.type"
							class="mat-chip mat-standard-chip timeline-day-item-{{ content.type }} event-chips">
							<div class="event-container" (click)="openShowDialog(dayContent.date, content)">
								<div *ngSwitchCase="'symptomLog'" class="event">
									{{ content.time }} : {{ symptomMap.get(content.key) }} [{{ content.pain }}/5]
								</div>
								<div *ngSwitchCase="'log'" class="event">
									{{ content.time }} : {{ content.key }}
								</div>
								<div *ngSwitchCase="'med'" class="event">
									{{ content.time }} : {{ content.key }} {{ content.quantity }}mg
								</div>
								<div *ngSwitchCase="'meal'" class="event">
									{{ content.time }} : {{ content.key }}
								</div>
								<div class="remove-event-container">
									<mat-icon matChipRemove *ngIf="dayContent.removable" class="remove-event"
										(click)="openDeleteDialog(dayContent.date, content)">
										cancel
									</mat-icon>
								</div>
							</div>
						</mat-chip>
						<div class="timeline-chips-padding"></div>
					</mat-chip-list>
				</div>
			</div>
		</mat-grid-tile>
	</div>
</mat-grid-list>

<ng-template #loading>
	<mat-spinner></mat-spinner>
</ng-template>